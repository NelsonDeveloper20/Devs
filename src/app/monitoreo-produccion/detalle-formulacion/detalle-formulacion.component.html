<ngx-spinner
  bdColor="rgba(255, 255, 255, 1)"
  size="medium"
  color="#0D7ABD"
  type="ball-beat"
  [fullScreen]="true"
  [name]="'cargandoProductos'"
>
  <p style="color: black">{{ spinnerMessage }}</p>
</ngx-spinner>

<h2 style="
    margin: -1px !important;" mat-dialog-title>Detalle Grupo Cotizacion  -  <b>{{DatosGrupo.cotizacionGrupo}} </b></h2>
    <!--  - {{DatosGrupo.accionamiento}} -->
<style>
    
  .search-input {
  position: sticky;
  top: 0;
  z-index: 1;
  background-color: white; /* Opcional: para asegurarse de que el campo de búsqueda esté sobre el contenido de la tabla */

  
  width: 100%;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
}
.mat-select-panel {
   
   min-width: 1112px !important;
   max-width: 1480px !important;
}
</style>
<div mat-dialog-content #tableElement >
    <div class="panel-body scroll-left">
      <!-- PRTRS -->
        <div class="table-container"  *ngIf="mostrarPRTRS">
            <table class="table table-sm mb-0 table-responsive-lg" id="dubcomponente" style="    font-size: 14px;">              
                 <thead class="sticky-top" style="color: black;"> 
                    <tr>
                      <th colspan="11" style="background: white;padding-bottom: 0px !important;">
                      <h4>PRTRS-Manual: <b>{{ ListComponenteProducto[0]?.producto }}</b></h4>
                      </th>
                    </tr>
                    <tr style="box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);  ">                       
                        <th nowrap style="    height: 8px !important;"></th>       
                        <th nowrap style="    height: 8px !important;">Tipo</th>       
                        <th nowrap style="    height: 8px !important;">Código Tipo<!--<input type="checkbox" [(ngModel)]="isEditableTipo">--> 
                        </th>
                        <th nowrap style="    height: 8px !important;">Descripción Tipo</th>
                        <th nowrap style="    height: 8px !important;">Ancho</th>
                        <th nowrap style="    height: 8px !important;">Alto</th>
                        <th nowrap style="    height: 8px !important;">Cant. Roller</th>
                        <th nowrap style="    height: 8px !important;">Cálculo Final <!--<input type="checkbox" [(ngModel)]="isEditableCalculo">--> 
                        </th>
                        <th nowrap style="    height: 8px !important;">Merma <!--a<nput type="checkbox" [(ngModel)]="isEditableMerma">--> 
                        </th>  
                        <th nowrap style="    height: 8px !important;">Lote <!--a<nput type="checkbox" [(ngModel)]="isEditableMerma">--> 
                        </th>  
                        <th nowrap style="    height: 8px !important;">  
                            <button class="btn btn-primary-azul tp-btn-light sharp"  title="Agregar Nuevo Componente"
                            (click)="openTablePopup('PRTRSMan')"><mat-icon>library_add</mat-icon> 
                            </button>
                        </th>
                        <th nowrap *ngIf="isFormulacion" style="    height: 8px !important;">
                        </th>
                    </tr>
                </thead>
                <tbody id="id_tabla"></tbody>
                <tbody style="color: #373434;">
                    <tr *ngFor="let comp of ListComponenteProducto;let i = index" > <!-- 
                        [ngStyle]="{'background': getBackgroundColor(comp.tipoDesc)}" -->
                    <td>
                            <button class="btn btn-primary tp-btn-light sharp" 
                            *ngIf="comp?.agregado !== 'true' && comp?.tipoDesc !== 'ACCESORIO'"
                            (click)="clonarComponente(comp,'PRTRSMan')" 
                            title="Clonar"
                            style="margin: 0px;  height: 0px !important;"><mat-icon>toll</mat-icon> 
                    </button>
                    </td>
                         <td class="sizeTd">{{ comp.tipoDesc }}</td>                
                        <td style="width: 124px !important;font-size: 12px !important;" class="sizeTd">  
                            <mat-form-field appearance="outline" style="width: 100%;" >
                                <mat-select  [disabled]="!isEditableTipo" [(ngModel)]="comp.codigoTipo" placeholder="Buscar" style="width: 190px;" (selectionChange)="onNombreChange($event, comp)">
                                <mat-select-trigger>
                                    <span *ngIf="!comp.codigoTipo">
                                        {{ comp.codigoTipo || '---Seleccione---' }}                                        
                                    </span>
                                    <span *ngIf="comp.codigoTipo">
                                        {{ comp.codigoTipo || comp.codigoTipo }}                                        
                                    </span>
                                </mat-select-trigger>
                                <input matInput (keyup)="applyFilter($event, comp)" placeholder="Buscar" class="search-input" />
                                <mat-option *ngIf="!comp.filteredOptions">Cargando...</mat-option> 
                                <mat-option *ngIf="!isOptionInFilteredOptions(comp.codigoTipo, comp.filteredOptions)" [value]="comp.codigoTipo">
                                    {{ comp.codigoTipo }} : {{ comp.codigoTipo }}
                                </mat-option>                                
                                <mat-option value="">---Seleccione---</mat-option>
                                <mat-option *ngFor="let item of comp.filteredOptions" [value]="item.codigoTipo">
                                {{ item.codigoTipo }} : {{ item.descripcionTipo }}
                                </mat-option>
                                </mat-select>
                              </mat-form-field>
                        </td>
                        <td class="sizeTd"> {{comp.descripcionTipo}}</td> 
                        <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
                            <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                            [(ngModel)]="comp.ancho"  *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>  
                            <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
                            <!-- (ngModelChange)="onComponentInputChange(comp)" -->

                        </td>  
                        <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
                            <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                            [(ngModel)]="comp.alto"  *ngIf="comp.tipoDesc === 'TELA'" />
                            <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>                        
                            <!--  (ngModelChange)="onComponentInputChange(comp)" -->
                        </td> 
                        <td class="sizeTd">                            
                            <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                            [(ngModel)]="comp.cantidadRoller" />
                            <!--  (ngModelChange)="onComponentInputChange(comp)"  -->
                        </td> 
                        <td style="min-width: 127px !important;" class="sizeTd">
                            <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                            [(ngModel)]="comp.calculoFinal"  (input)="validateAndFormatInput($event)" [disabled]="!isEditableCalculo"/>
                        </td>
                        <td style="min-width: 55px !important;" class="sizeTd">
                            <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                            [(ngModel)]="comp.merma"  (input)="validateAndFormatInput($event)" [disabled]="!isEditableMerma"
                            *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>
                            <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
                        </td>      
                    <td style="min-width: 55px !important;" class="sizeTd">
                    <textarea class="form-control input-sm"   rows="1"  style="height: 50px !important; font-size: 14px;"   [(ngModel)]="comp.lote"                   
                     *ngIf="comp.tipoDesc === 'TELA'">
                    </textarea>
                    <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>
                    </td>

                        <td class="sizeTd">
                                <button class="btn btn-primary tp-btn-light sharp" *ngIf="comp?.agregado==='true'" title="Eliminar"
                                    (click)="eliminarItemAgregado(comp,'PRTRSMan')">
                                    <mat-icon>delete_forever</mat-icon>
                                </button>
                        </td>
                        
                        <td *ngIf="isFormulacion" class="sizeTd"> 
                          </td> 
                    </tr>
                </tbody> 
            </table> 
        
            <hr>
          </div>
        
      <!-- PRTRS MOTORIZADO-->
      <div class="table-container"  *ngIf="mostrarPRTRSMot">
        <table class="table table-sm mb-0 table-responsive-lg" id="dubcomponente" style="    font-size: 14px;">              
             <thead class="sticky-top" style="color: black;"> 
                <tr>
                  <th colspan="11" style="background: white;padding-bottom: 0px !important;">
                  <h4>PRTRS-Motorizado: <b>{{ ListComponenteProductoMot[0]?.producto }}</b></h4>
                  </th>
                </tr>
                <tr style="box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);  ">                       
                    <th nowrap style="    height: 8px !important;"></th>       
                    <th nowrap style="    height: 8px !important;">Tipo</th>       
                    <th nowrap style="    height: 8px !important;">Código Tipo<!--<input type="checkbox" [(ngModel)]="isEditableTipo">--> 
                    </th>
                    <th nowrap style="    height: 8px !important;">Descripción Tipo</th>
                    <th nowrap style="    height: 8px !important;">Ancho</th>
                    <th nowrap style="    height: 8px !important;">Alto</th>
                    <th nowrap style="    height: 8px !important;">Cant. Roller</th>
                    <th nowrap style="    height: 8px !important;">Cálculo Final <!--<input type="checkbox" [(ngModel)]="isEditableCalculo">--> 
                    </th>
                    <th nowrap style="    height: 8px !important;">Merma <!--a<nput type="checkbox" [(ngModel)]="isEditableMerma">--> 
                    </th>  
                    <th nowrap style="    height: 8px !important;">Lote <!--a<nput type="checkbox" [(ngModel)]="isEditableMerma">--> 
                    </th>  
                    <th nowrap style="    height: 8px !important;">  
                        <button class="btn btn-primary-azul tp-btn-light sharp"  title="Agregar Nuevo Componente"
                        (click)="openTablePopup('PRTRSMot')"><mat-icon>library_add</mat-icon> 
                        </button>                         
          
                    </th>
                    <th nowrap *ngIf="isFormulacion" style="    height: 8px !important;">                    
                    </th>
                </tr>
            </thead>
            <tbody id="id_tabla"></tbody>
            <tbody style="color: #373434;">
                <tr *ngFor="let comp of ListComponenteProductoMot;let i = index" > <!-- 
                    [ngStyle]="{'background': getBackgroundColor(comp.tipoDesc)}" -->
                <td>
                        <button class="btn btn-primary tp-btn-light sharp" 
                        *ngIf="comp?.agregado !== 'true' && comp?.tipoDesc !== 'ACCESORIO'"
                        (click)="clonarComponente(comp,'PRTRSMot')" 
                        title="Clonar"
                        style="margin: 0px;  height: 0px !important;"><mat-icon>toll</mat-icon> 
                </button>
                </td>
                     <td class="sizeTd">{{ comp.tipoDesc }}</td>                
                    <td style="width: 124px !important;font-size: 12px !important;" class="sizeTd">  
                        <mat-form-field appearance="outline" style="width: 100%;" >
                            <mat-select  [disabled]="!isEditableTipo" [(ngModel)]="comp.codigoTipo" placeholder="Buscar" style="width: 190px;" (selectionChange)="onNombreChange($event, comp)">
                            <mat-select-trigger>
                                <span *ngIf="!comp.codigoTipo">
                                    {{ comp.codigoTipo || '---Seleccione---' }}                                        
                                </span>
                                <span *ngIf="comp.codigoTipo">
                                    {{ comp.codigoTipo || comp.codigoTipo }}                                        
                                </span>
                            </mat-select-trigger>
                            <input matInput (keyup)="applyFilter($event, comp)" placeholder="Buscar" class="search-input" />
                            <mat-option *ngIf="!comp.filteredOptions">Cargando...</mat-option> 
                            <mat-option *ngIf="!isOptionInFilteredOptions(comp.codigoTipo, comp.filteredOptions)" [value]="comp.codigoTipo">
                                {{ comp.codigoTipo }} : {{ comp.codigoTipo }}
                            </mat-option>                                
                            <mat-option value="">---Seleccione---</mat-option>
                            <mat-option *ngFor="let item of comp.filteredOptions" [value]="item.codigoTipo">
                            {{ item.codigoTipo }} : {{ item.descripcionTipo }}
                            </mat-option>
                            </mat-select>
                          </mat-form-field>
                    </td>
                    <td class="sizeTd"> {{comp.descripcionTipo}}</td> 
                    <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
                        <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                        [(ngModel)]="comp.ancho"  *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>  
                        <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
                        <!-- (ngModelChange)="onComponentInputChange(comp)" -->

                    </td>  
                    <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
                        <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                        [(ngModel)]="comp.alto"  *ngIf="comp.tipoDesc === 'TELA'" />
                        <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>                        
                        <!--  (ngModelChange)="onComponentInputChange(comp)" -->
                    </td> 
                    <td class="sizeTd">                            
                        <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                        [(ngModel)]="comp.cantidadRoller" />
                        <!--  (ngModelChange)="onComponentInputChange(comp)"  -->
                    </td> 
                    <td style="min-width: 127px !important;" class="sizeTd">
                        <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                        [(ngModel)]="comp.calculoFinal"  (input)="validateAndFormatInput($event)" [disabled]="!isEditableCalculo"/>
                    </td>
                    <td style="min-width: 55px !important;" class="sizeTd">
                        <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                        [(ngModel)]="comp.merma"  (input)="validateAndFormatInput($event)" [disabled]="!isEditableMerma"
                        *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>
                        <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
                    </td>       
                    <td style="min-width: 55px !important;" class="sizeTd">
                    <textarea class="form-control input-sm"   rows="1"  style="height: 50px !important; font-size: 14px;"   [(ngModel)]="comp.lote"                   
                     *ngIf="comp.tipoDesc === 'TELA'">
                    </textarea>
                    <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>
                    </td>
                    <td class="sizeTd">
                            <button class="btn btn-primary tp-btn-light sharp" *ngIf="comp?.agregado==='true'" title="Eliminar"
                                (click)="eliminarItemAgregado(comp,'PRTRSMot')">
                                <mat-icon>delete_forever</mat-icon>
                            </button>
                    </td>
                    
                    <td *ngIf="isFormulacion" class="sizeTd">  
                      </td> 
                </tr>
            </tbody> 
        </table> 
    
        <hr>
      </div>
      <!-- PRTRZ -->
      <div class="table-container"  *ngIf="mostrarPRTRZ"> 
          <table class="table table-sm mb-0 table-responsive-lg" id="dubcomponente" style="    font-size: 14px;">              
               <thead class="sticky-top" style="color: black;">
                <tr>
                  <th colspan="11" style="background: white;padding-bottom: 0px !important;">
                  <h4>PRTRZ: <b>{{ ListComponenteProductoPRTRZ[0]?.producto }}</b></h4>
                  </th>
                </tr>
                  <tr style="box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);  ">                       
                      <th nowrap style="    height: 8px !important;"></th>       
                      <th nowrap style="    height: 8px !important;">Tipo</th>       
                      <th nowrap style="    height: 8px !important;">Código Tipo<!--<input type="checkbox" [(ngModel)]="isEditableTipo">--> 
                      </th>
                      <th nowrap style="    height: 8px !important;">Descripción Tipo</th>
                      <th nowrap style="    height: 8px !important;">Ancho</th>
                      <th nowrap style="    height: 8px !important;">Alto</th>
                      <th nowrap style="    height: 8px !important;">Cant. Roller</th>
                      <th nowrap style="    height: 8px !important;">Cálculo Final <!--<input type="checkbox" [(ngModel)]="isEditableCalculo">--> 
                      </th>
                      <th nowrap style="    height: 8px !important;">Merma <!--a<nput type="checkbox" [(ngModel)]="isEditableMerma">--> 
                      </th>  
                      <th nowrap style="    height: 8px !important;">Lote <!--a<nput type="checkbox" [(ngModel)]="isEditableMerma">--> 
                      </th>  
                      <th nowrap style="    height: 8px !important;">  
                          <button class="btn btn-primary-azul tp-btn-light sharp"  title="Agregar Nuevo Componente"
                          (click)="openTablePopup('PRTRZ')"><mat-icon>library_add</mat-icon> 
                          </button>        
                      </th>
                      <th nowrap *ngIf="isFormulacion" style="    height: 8px !important;">                        
                      </th>
                  </tr>
              </thead>
              <tbody id="id_tabla"></tbody>
              <tbody style="color: #373434;">
                  <tr *ngFor="let comp of ListComponenteProductoPRTRZ;let i = index" > <!-- 
                      [ngStyle]="{'background': getBackgroundColor(comp.tipoDesc)}" -->
                  <td>
                          <button class="btn btn-primary tp-btn-light sharp" 
                          *ngIf="comp?.agregado !== 'true' && comp?.tipoDesc !== 'ACCESORIO'"
                          (click)="clonarComponente(comp,'PRTRZ')" 
                          title="Clonar"
                          style="margin: 0px;  height: 0px !important;"><mat-icon>toll</mat-icon> 
                  </button>
                  </td>
                       <td class="sizeTd">{{ comp.tipoDesc }}</td>                
                      <td style="width: 124px !important;font-size: 12px !important;" class="sizeTd">  
                          <mat-form-field appearance="outline" style="width: 100%;" >
                              <mat-select  [disabled]="!isEditableTipo" [(ngModel)]="comp.codigoTipo" placeholder="Buscar" style="width: 190px;" (selectionChange)="onNombreChange($event, comp)">
                              <mat-select-trigger>
                                  <span *ngIf="!comp.codigoTipo">
                                      {{ comp.codigoTipo || '---Seleccione---' }}                                        
                                  </span>
                                  <span *ngIf="comp.codigoTipo">
                                      {{ comp.codigoTipo || comp.codigoTipo }}                                        
                                  </span>
                              </mat-select-trigger>
                              <input matInput (keyup)="applyFilter($event, comp)" placeholder="Buscar" class="search-input" />
                              <mat-option *ngIf="!comp.filteredOptions">Cargando...</mat-option> 
                              <mat-option *ngIf="!isOptionInFilteredOptions(comp.codigoTipo, comp.filteredOptions)" [value]="comp.codigoTipo">
                                  {{ comp.codigoTipo }} : {{ comp.codigoTipo }}
                              </mat-option>                                
                              <mat-option value="">---Seleccione---</mat-option>
                              <mat-option *ngFor="let item of comp.filteredOptions" [value]="item.codigoTipo">
                              {{ item.codigoTipo }} : {{ item.descripcionTipo }}
                              </mat-option>
                              </mat-select>
                            </mat-form-field>
                      </td>
                      <td class="sizeTd"> {{comp.descripcionTipo}}</td> 
                      <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
                          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                          [(ngModel)]="comp.ancho"  *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>  
                          <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
                          <!-- (ngModelChange)="onComponentInputChange(comp)" -->

                      </td>  
                      <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
                          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                          [(ngModel)]="comp.alto"  *ngIf="comp.tipoDesc === 'TELA'" />
                          <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>                        
                          <!--  (ngModelChange)="onComponentInputChange(comp)" -->
                      </td> 
                      <td class="sizeTd">                            
                          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                          [(ngModel)]="comp.cantidadRoller" />
                          <!--  (ngModelChange)="onComponentInputChange(comp)"  -->
                      </td> 
                      <td style="min-width: 127px !important;" class="sizeTd">
                          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                          [(ngModel)]="comp.calculoFinal"  (input)="validateAndFormatInput($event)" [disabled]="!isEditableCalculo"/>
                      </td>
                      <td style="min-width: 55px !important;" class="sizeTd">
                          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                          [(ngModel)]="comp.merma"  (input)="validateAndFormatInput($event)" [disabled]="!isEditableMerma"
                          *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>
                          <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
                      </td>      
                    <td style="min-width: 55px !important;" class="sizeTd">
                    <textarea class="form-control input-sm"   rows="1"  style="height: 50px !important; font-size: 14px;"   [(ngModel)]="comp.lote"                   
                     *ngIf="comp.tipoDesc === 'TELA'">
                    </textarea>
                    <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>
                    </td>
                      <td class="sizeTd">
                              <button class="btn btn-primary tp-btn-light sharp" *ngIf="comp?.agregado==='true'" title="Eliminar"
                                  (click)="eliminarItemAgregado(comp,'PRTRZ')">
                                  <mat-icon>delete_forever</mat-icon>
                              </button>
                      </td>
                      
                      <td *ngIf="isFormulacion" class="sizeTd">
                        </td> 
                  </tr>
              </tbody> 
          </table> 
     
          <hr>
        </div>
      
        <!-- PRTRM00000016 -->
<div class="table-container" *ngIf="mostrarPRTRM00000016"> 
  <table class="table table-sm mb-0 table-responsive-lg"   style="font-size: 14px;">              
    <thead class="sticky-top" style="color: black;">
      <tr>
        <th colspan="11" style="background: white;padding-bottom: 0px !important;">
        <h4>PRTRM16: <b>{{ ListComponenteProductoPRTRM00000016[0]?.producto }}</b></h4>
        </th>
      </tr>
      <tr style="box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);">                       
        <th nowrap style="height: 8px !important;"></th>       
        <th nowrap style="height: 8px !important;">Tipo</th>       
        <th nowrap style="height: 8px !important;">Código Tipo</th>
        <th nowrap style="height: 8px !important;">Descripción Tipo</th>
        <th nowrap style="height: 8px !important;">Ancho</th>
        <th nowrap style="height: 8px !important;">Alto</th>
        <th nowrap style="height: 8px !important;">Cant. Roller</th>
        <th nowrap style="height: 8px !important;">Cálculo Final</th>
        <th nowrap style="height: 8px !important;">Merma</th>    
        <th nowrap style="height: 8px !important;">Lote</th>  
        <th nowrap style="height: 8px !important;">  
          <button class="btn btn-primary-azul tp-btn-light sharp" title="Agregar Nuevo Componente"
                  (click)="openTablePopup('PRTRM00000016')"><mat-icon>library_add</mat-icon></button> 
        </th>
        <th nowrap *ngIf="isFormulacion" style="height: 8px !important;"></th>
      </tr>
    </thead> 
    <tbody style="color: #373434;">
      <tr *ngFor="let comp of ListComponenteProductoPRTRM00000016; let i = index">
        <td>
          <button class="btn btn-primary tp-btn-light sharp" 
                  *ngIf="comp?.agregado !== 'true' && comp?.tipoDesc !== 'ACCESORIO'"
                  (click)="clonarComponente(comp,'PRTRM00000016')" 
                  title="Clonar"
                  style="margin: 0px; height: 0px !important;"><mat-icon>toll</mat-icon></button>
        </td>
        <td class="sizeTd">{{ comp.tipoDesc }}</td>                
        <td style="width: 124px !important;font-size: 12px !important;" class="sizeTd">  
          <mat-form-field appearance="outline" style="width: 100%;">
            <mat-select [disabled]="!isEditableTipo" [(ngModel)]="comp.codigoTipo" placeholder="Buscar" style="width: 190px;" (selectionChange)="onNombreChange($event, comp)">
              <mat-select-trigger>
                <span *ngIf="!comp.codigoTipo">
                  {{ comp.codigoTipo || '---Seleccione---' }}                                        
                </span>
                <span *ngIf="comp.codigoTipo">
                  {{ comp.codigoTipo || comp.codigoTipo }}                                        
                </span>
              </mat-select-trigger>
              <input matInput (keyup)="applyFilter($event, comp)" placeholder="Buscar" class="search-input" />
              <mat-option *ngIf="!comp.filteredOptions">Cargando...</mat-option> 
              <mat-option *ngIf="!isOptionInFilteredOptions(comp.codigoTipo, comp.filteredOptions)" [value]="comp.codigoTipo">
                {{ comp.codigoTipo }} : {{ comp.codigoTipo }}
              </mat-option>                                
              <mat-option value="">---Seleccione---</mat-option>
              <mat-option *ngFor="let item of comp.filteredOptions" [value]="item.codigoTipo">
                {{ item.codigoTipo }} : {{ item.descripcionTipo }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </td>
        <td class="sizeTd">{{comp.descripcionTipo}}</td> 
        <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.ancho" *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>  
          <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
        </td>  
        <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.alto" *ngIf="comp.tipoDesc === 'TELA'" />
          <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>                        
        </td> 
        <td class="sizeTd">                            
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.cantidadRoller" />
        </td> 
        <td style="min-width: 127px !important;" class="sizeTd">
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.calculoFinal" (input)="validateAndFormatInput($event)" [disabled]="!isEditableCalculo"/>
        </td>
        <td style="min-width: 55px !important;" class="sizeTd">
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.merma" (input)="validateAndFormatInput($event)" [disabled]="!isEditableMerma"
                 *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>
          <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
        </td>  
                    <td style="min-width: 55px !important;" class="sizeTd">
                    <textarea class="form-control input-sm"   rows="1"  style="height: 50px !important; font-size: 14px;"   [(ngModel)]="comp.lote"                   
                     *ngIf="comp.tipoDesc === 'TELA'">
                    </textarea>
                    <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>
                    </td>
        <td class="sizeTd">
          <button class="btn btn-primary tp-btn-light sharp" *ngIf="comp?.agregado==='true'" title="Eliminar"
                  (click)="eliminarItemAgregado(comp,'PRTRM00000016')">
            <mat-icon>delete_forever</mat-icon>
          </button>
        </td>
        <td *ngIf="isFormulacion" class="sizeTd"></td> 
      </tr>
    </tbody> 
  </table>   
  <hr>
</div> 
<!-- PRTRM00000001 -->
<div class="table-container" *ngIf="mostrarPRTRM00000001"> 
  <table class="table table-sm mb-0 table-responsive-lg" id="dubcomponentePRTRM00000001" style="font-size: 14px;">              
    <thead class="sticky-top" style="color: black;">
      <tr>
        <th colspan="11" style="background: white;padding-bottom: 0px !important;">
        <h4>PRTRM: <b>{{ ListComponenteProductoPRTRM00000001[0]?.producto }}</b></h4>
        </th>
      </tr>
      <tr style="box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);">                       
        <th nowrap style="height: 8px !important;"></th>       
        <th nowrap style="height: 8px !important;">Tipo</th>       
        <th nowrap style="height: 8px !important;">Código Tipo</th>
        <th nowrap style="height: 8px !important;">Descripción Tipo</th>
        <th nowrap style="height: 8px !important;">Ancho</th>
        <th nowrap style="height: 8px !important;">Alto</th>
        <th nowrap style="height: 8px !important;">Cant. Roller</th>
        <th nowrap style="height: 8px !important;">Cálculo Final</th>
        <th nowrap style="height: 8px !important;">Merma</th>    
        <th nowrap style="height: 8px !important;">Lote</th>  
        <th nowrap style="height: 8px !important;">  
          <button class="btn btn-primary-azul tp-btn-light sharp" title="Agregar Nuevo Componente"
                  (click)="openTablePopup('PRTRM00000001')"><mat-icon>library_add</mat-icon></button> 
        </th>
        <th nowrap *ngIf="isFormulacion" style="height: 8px !important;"></th>
      </tr>
    </thead> 
    <tbody style="color: #373434;">
      <tr *ngFor="let comp of ListComponenteProductoPRTRM00000001; let i = index">
        <td>
          <button class="btn btn-primary tp-btn-light sharp" 
                  *ngIf="comp?.agregado !== 'true' && comp?.tipoDesc !== 'ACCESORIO'"
                  (click)="clonarComponente(comp,'PRTRM00000001')" 
                  title="Clonar"
                  style="margin: 0px; height: 0px !important;"><mat-icon>toll</mat-icon></button>
        </td>
        <td class="sizeTd">{{ comp.tipoDesc }}</td>                
        <td style="width: 124px !important;font-size: 12px !important;" class="sizeTd">  
          <mat-form-field appearance="outline" style="width: 100%;">
            <mat-select [disabled]="!isEditableTipo" [(ngModel)]="comp.codigoTipo" placeholder="Buscar" style="width: 190px;" (selectionChange)="onNombreChange($event, comp)">
              <mat-select-trigger>
                <span *ngIf="!comp.codigoTipo">
                  {{ comp.codigoTipo || '---Seleccione---' }}                                        
                </span>
                <span *ngIf="comp.codigoTipo">
                  {{ comp.codigoTipo || comp.codigoTipo }}                                        
                </span>
              </mat-select-trigger>
              <input matInput (keyup)="applyFilter($event, comp)" placeholder="Buscar" class="search-input" />
              <mat-option *ngIf="!comp.filteredOptions">Cargando...</mat-option> 
              <mat-option *ngIf="!isOptionInFilteredOptions(comp.codigoTipo, comp.filteredOptions)" [value]="comp.codigoTipo">
                {{ comp.codigoTipo }} : {{ comp.codigoTipo }}
              </mat-option>                                
              <mat-option value="">---Seleccione---</mat-option>
              <mat-option *ngFor="let item of comp.filteredOptions" [value]="item.codigoTipo">
                {{ item.codigoTipo }} : {{ item.descripcionTipo }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </td>
        <td class="sizeTd">{{comp.descripcionTipo}}</td> 
        <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.ancho" *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>  
          <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
        </td>  
        <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.alto" *ngIf="comp.tipoDesc === 'TELA'" />
          <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>                        
        </td> 
        <td class="sizeTd">                            
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.cantidadRoller" />
        </td> 
        <td style="min-width: 127px !important;" class="sizeTd">
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.calculoFinal" (input)="validateAndFormatInput($event)" [disabled]="!isEditableCalculo"/>
        </td>
        <td style="min-width: 55px !important;" class="sizeTd">
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.merma" (input)="validateAndFormatInput($event)" [disabled]="!isEditableMerma"
                 *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>
          <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
        </td>  
                    <td style="min-width: 55px !important;" class="sizeTd">
                    <textarea class="form-control input-sm"   rows="1"  style="height: 50px !important; font-size: 14px;"   [(ngModel)]="comp.lote"                   
                     *ngIf="comp.tipoDesc === 'TELA'">
                    </textarea>
                    <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>
                    </td>
        <td class="sizeTd">
          <button class="btn btn-primary tp-btn-light sharp" *ngIf="comp?.agregado==='true'" title="Eliminar"
                  (click)="eliminarItemAgregado(comp,'PRTRM00000001')">
            <mat-icon>delete_forever</mat-icon>
          </button>
        </td>
        <td *ngIf="isFormulacion" class="sizeTd"></td> 
      </tr>
    </tbody> 
  </table>   
  <hr>
</div> 
<!-- PRTRH00000001 -->
<div class="table-container" *ngIf="mostrarPRTRH00000001"> 
  <table class="table table-sm mb-0 table-responsive-lg" id="dubcomponentePRTRH00000001" style="font-size: 14px;">              
    <thead class="sticky-top" style="color: black;">
      <tr>
        <th colspan="11" style="background: white;padding-bottom: 0px !important;">
        <h4>PRTRH: <b>{{ ListComponenteProductoPRTRH00000001[0]?.producto }}</b></h4>
        </th>
      </tr>
      <tr style="box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);">                       
        <th nowrap style="height: 8px !important;"></th>       
        <th nowrap style="height: 8px !important;">Tipo</th>       
        <th nowrap style="height: 8px !important;">Código Tipo</th>
        <th nowrap style="height: 8px !important;">Descripción Tipo</th>
        <th nowrap style="height: 8px !important;">Ancho</th>
        <th nowrap style="height: 8px !important;">Alto</th>
        <th nowrap style="height: 8px !important;">Cant. Roller</th>
        <th nowrap style="height: 8px !important;">Cálculo Final</th>
        <th nowrap style="height: 8px !important;">Merma</th>    
        <th nowrap style="height: 8px !important;">Lote</th>  
        <th nowrap style="height: 8px !important;">  
          <button class="btn btn-primary-azul tp-btn-light sharp" title="Agregar Nuevo Componente"
                  (click)="openTablePopup('PRTRH00000001')"><mat-icon>library_add</mat-icon></button> 
        </th>
        <th nowrap *ngIf="isFormulacion" style="height: 8px !important;"></th>
      </tr>
    </thead> 
    <tbody style="color: #373434;">
      <tr *ngFor="let comp of ListComponenteProductoPRTRH00000001; let i = index">
        <td>
          <button class="btn btn-primary tp-btn-light sharp" 
                  *ngIf="comp?.agregado !== 'true' && comp?.tipoDesc !== 'ACCESORIO'"
                  (click)="clonarComponente(comp,'PRTRH00000001')" 
                  title="Clonar"
                  style="margin: 0px; height: 0px !important;"><mat-icon>toll</mat-icon></button>
        </td>
        <td class="sizeTd">{{ comp.tipoDesc }}</td>                
        <td style="width: 124px !important;font-size: 12px !important;" class="sizeTd">  
          <mat-form-field appearance="outline" style="width: 100%;">
            <mat-select [disabled]="!isEditableTipo" [(ngModel)]="comp.codigoTipo" placeholder="Buscar" style="width: 190px;" (selectionChange)="onNombreChange($event, comp)">
              <mat-select-trigger>
                <span *ngIf="!comp.codigoTipo">
                  {{ comp.codigoTipo || '---Seleccione---' }}                                        
                </span>
                <span *ngIf="comp.codigoTipo">
                  {{ comp.codigoTipo || comp.codigoTipo }}                                        
                </span>
              </mat-select-trigger>
              <input matInput (keyup)="applyFilter($event, comp)" placeholder="Buscar" class="search-input" />
              <mat-option *ngIf="!comp.filteredOptions">Cargando...</mat-option> 
              <mat-option *ngIf="!isOptionInFilteredOptions(comp.codigoTipo, comp.filteredOptions)" [value]="comp.codigoTipo">
                {{ comp.codigoTipo }} : {{ comp.codigoTipo }}
              </mat-option>                                
              <mat-option value="">---Seleccione---</mat-option>
              <mat-option *ngFor="let item of comp.filteredOptions" [value]="item.codigoTipo">
                {{ item.codigoTipo }} : {{ item.descripcionTipo }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </td>
        <td class="sizeTd">{{comp.descripcionTipo}}</td> 
        <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.ancho" *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>  
          <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
        </td>  
        <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.alto" *ngIf="comp.tipoDesc === 'TELA'" />
          <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>                        
        </td> 
        <td class="sizeTd">                            
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.cantidadRoller" />
        </td> 
        <td style="min-width: 127px !important;" class="sizeTd">
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.calculoFinal" (input)="validateAndFormatInput($event)" [disabled]="!isEditableCalculo"/>
        </td>
        <td style="min-width: 55px !important;" class="sizeTd">
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.merma" (input)="validateAndFormatInput($event)" [disabled]="!isEditableMerma"
                 *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>
          <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
        </td>  
                    <td style="min-width: 55px !important;" class="sizeTd">
                    <textarea class="form-control input-sm"   rows="1"  style="height: 50px !important; font-size: 14px;"   [(ngModel)]="comp.lote"                   
                     *ngIf="comp.tipoDesc === 'TELA'">
                    </textarea>
                    <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>
                    </td>
        <td class="sizeTd">
          <button class="btn btn-primary tp-btn-light sharp" *ngIf="comp?.agregado==='true'" title="Eliminar"
                  (click)="eliminarItemAgregado(comp,'PRTRH00000001')">
            <mat-icon>delete_forever</mat-icon>
          </button>
        </td>
        <td *ngIf="isFormulacion" class="sizeTd"></td> 
      </tr>
    </tbody> 
  </table> 
  <hr>
</div>
 
<!-- PRTCV -->
<div class="table-container" *ngIf="mostrarPRTCV"> 
  <table class="table table-sm mb-0 table-responsive-lg"  style="font-size: 14px;">              
    <thead class="sticky-top" style="color: black;">
      <tr>
        <th colspan="11" style="background: white;padding-bottom: 0px !important;">
        <h4>PRTCV: <b>{{ ListComponenteProductoPRTCV[0]?.producto }}</b></h4>
        </th>
      </tr>
      <tr style="box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);">                       
        <th nowrap style="height: 8px !important;"></th>       
        <th nowrap style="height: 8px !important;">Tipo</th>       
        <th nowrap style="height: 8px !important;">Código Tipo</th>
        <th nowrap style="height: 8px !important;">Descripción Tipo</th>
        <th nowrap style="height: 8px !important;">Ancho</th>
        <th nowrap style="height: 8px !important;">Alto</th>
        <th nowrap style="height: 8px !important;">Cant. Roller</th>
        <th nowrap style="height: 8px !important;">Cálculo Final</th>
        <th nowrap style="height: 8px !important;">Merma</th>    
        <th nowrap style="height: 8px !important;">Lote</th>  
        <th nowrap style="height: 8px !important;">  
          <button class="btn btn-primary-azul tp-btn-light sharp" title="Agregar Nuevo Componente"
                  (click)="openTablePopup('PRTCV')"><mat-icon>library_add</mat-icon></button> 
        </th>
        <th nowrap *ngIf="isFormulacion" style="height: 8px !important;"></th>
      </tr>
    </thead> 
    <tbody style="color: #373434;">
      <tr *ngFor="let comp of ListComponenteProductoPRTCV; let i = index">
        <td>
          <button class="btn btn-primary tp-btn-light sharp" 
                  *ngIf="comp?.agregado !== 'true' && comp?.tipoDesc !== 'ACCESORIO'"
                  (click)="clonarComponente(comp,'PRTCV')" 
                  title="Clonar"
                  style="margin: 0px; height: 0px !important;"><mat-icon>toll</mat-icon></button>
        </td>
        <td class="sizeTd">{{ comp.tipoDesc }}</td>                
        <td style="width: 124px !important;font-size: 12px !important;" class="sizeTd">  
          <mat-form-field appearance="outline" style="width: 100%;">
            <mat-select [disabled]="!isEditableTipo" [(ngModel)]="comp.codigoTipo" placeholder="Buscar" style="width: 190px;" (selectionChange)="onNombreChange($event, comp)">
              <mat-select-trigger>
                <span *ngIf="!comp.codigoTipo">
                  {{ comp.codigoTipo || '---Seleccione---' }}                                        
                </span>
                <span *ngIf="comp.codigoTipo">
                  {{ comp.codigoTipo || comp.codigoTipo }}                                        
                </span>
              </mat-select-trigger>
              <input matInput (keyup)="applyFilter($event, comp)" placeholder="Buscar" class="search-input" />
              <mat-option *ngIf="!comp.filteredOptions">Cargando...</mat-option> 
              <mat-option *ngIf="!isOptionInFilteredOptions(comp.codigoTipo, comp.filteredOptions)" [value]="comp.codigoTipo">
                {{ comp.codigoTipo }} : {{ comp.codigoTipo }}
              </mat-option>                                
              <mat-option value="">---Seleccione---</mat-option>
              <mat-option *ngFor="let item of comp.filteredOptions" [value]="item.codigoTipo">
                {{ item.codigoTipo }} : {{ item.descripcionTipo }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </td>
        <td class="sizeTd">{{comp.descripcionTipo}}</td> 
        <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.ancho" *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>  
          <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
        </td>  
        <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.alto" *ngIf="comp.tipoDesc === 'TELA'" />
          <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>                        
        </td> 
        <td class="sizeTd">                            
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.cantidadRoller" />
        </td> 
        <td style="min-width: 127px !important;" class="sizeTd">
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.calculoFinal" (input)="validateAndFormatInput($event)" [disabled]="!isEditableCalculo"/>
        </td>
        <td style="min-width: 55px !important;" class="sizeTd">
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.merma" (input)="validateAndFormatInput($event)" [disabled]="!isEditableMerma"
                 *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>
          <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
        </td>  
                    <td style="min-width: 55px !important;" class="sizeTd">
                    <textarea class="form-control input-sm"   rows="1"  style="height: 50px !important; font-size: 14px;"   [(ngModel)]="comp.lote"                   
                     *ngIf="comp.tipoDesc === 'TELA'">
                    </textarea>
                    <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>
                    </td>
        <td class="sizeTd">
          <button class="btn btn-primary tp-btn-light sharp" *ngIf="comp?.agregado==='true'" title="Eliminar"
                  (click)="eliminarItemAgregado(comp,'PRTCV')">
            <mat-icon>delete_forever</mat-icon>
          </button>
        </td>
        <td *ngIf="isFormulacion" class="sizeTd"></td> 
      </tr>
    </tbody> 
  </table> 
  <hr>
</div>
<!-- PRTRF00000001 -->
<div class="table-container" *ngIf="mostrarPRTRF00000001"> 
  <table class="table table-sm mb-0 table-responsive-lg" id="dubcomponentePRTRH00000001" style="font-size: 14px;">              
    <thead class="sticky-top" style="color: black;">
      <tr>
        <th colspan="11" style="background: white;padding-bottom: 0px !important;">
        <h4>PRTRF: <b>{{ ListComponenteProductoPRTRF00000001[0]?.producto }}</b></h4>
        </th>
      </tr>
      <tr style="box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);">                       
        <th nowrap style="height: 8px !important;"></th>       
        <th nowrap style="height: 8px !important;">Tipo</th>       
        <th nowrap style="height: 8px !important;">Código Tipo</th>
        <th nowrap style="height: 8px !important;">Descripción Tipo</th>
        <th nowrap style="height: 8px !important;">Ancho</th>
        <th nowrap style="height: 8px !important;">Alto</th>
        <th nowrap style="height: 8px !important;">Cant. Roller</th>
        <th nowrap style="height: 8px !important;">Cálculo Final</th>
        <th nowrap style="height: 8px !important;">Merma</th>    
        <th nowrap style="height: 8px !important;">Lote</th>  
        <th nowrap style="height: 8px !important;">  
          <button class="btn btn-primary-azul tp-btn-light sharp" title="Agregar Nuevo Componente"
                  (click)="openTablePopup('PRTRF00000001')"><mat-icon>library_add</mat-icon></button> 
        </th>
        <th nowrap *ngIf="isFormulacion" style="height: 8px !important;"></th>
      </tr>
    </thead> 
    <tbody style="color: #373434;">
      <tr *ngFor="let comp of ListComponenteProductoPRTRF00000001; let i = index">
        <td>
          <button class="btn btn-primary tp-btn-light sharp" 
                  *ngIf="comp?.agregado !== 'true' && comp?.tipoDesc !== 'ACCESORIO'"
                  (click)="clonarComponente(comp,'PRTRF00000001')" 
                  title="Clonar"
                  style="margin: 0px; height: 0px !important;"><mat-icon>toll</mat-icon></button>
        </td>
        <td class="sizeTd">{{ comp.tipoDesc }}</td>                
        <td style="width: 124px !important;font-size: 12px !important;" class="sizeTd">  
          <mat-form-field appearance="outline" style="width: 100%;">
            <mat-select [disabled]="!isEditableTipo" [(ngModel)]="comp.codigoTipo" placeholder="Buscar" style="width: 190px;" (selectionChange)="onNombreChange($event, comp)">
              <mat-select-trigger>
                <span *ngIf="!comp.codigoTipo">
                  {{ comp.codigoTipo || '---Seleccione---' }}                                        
                </span>
                <span *ngIf="comp.codigoTipo">
                  {{ comp.codigoTipo || comp.codigoTipo }}                                        
                </span>
              </mat-select-trigger>
              <input matInput (keyup)="applyFilter($event, comp)" placeholder="Buscar" class="search-input" />
              <mat-option *ngIf="!comp.filteredOptions">Cargando...</mat-option> 
              <mat-option *ngIf="!isOptionInFilteredOptions(comp.codigoTipo, comp.filteredOptions)" [value]="comp.codigoTipo">
                {{ comp.codigoTipo }} : {{ comp.codigoTipo }}
              </mat-option>                                
              <mat-option value="">---Seleccione---</mat-option>
              <mat-option *ngFor="let item of comp.filteredOptions" [value]="item.codigoTipo">
                {{ item.codigoTipo }} : {{ item.descripcionTipo }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </td>
        <td class="sizeTd">{{comp.descripcionTipo}}</td> 
        <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.ancho" *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>  
          <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
        </td>  
        <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.alto" *ngIf="comp.tipoDesc === 'TELA'" />
          <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>                        
        </td> 
        <td class="sizeTd">                            
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.cantidadRoller" />
        </td> 
        <td style="min-width: 127px !important;" class="sizeTd">
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.calculoFinal" (input)="validateAndFormatInput($event)" [disabled]="!isEditableCalculo"/>
        </td>
        <td style="min-width: 55px !important;" class="sizeTd">
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.merma" (input)="validateAndFormatInput($event)" [disabled]="!isEditableMerma"
                 *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>
          <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
        </td>  
                    <td style="min-width: 55px !important;" class="sizeTd">
                    <textarea class="form-control input-sm"   rows="1"  style="height: 50px !important; font-size: 14px;"   [(ngModel)]="comp.lote"                   
                     *ngIf="comp.tipoDesc === 'TELA'">
                    </textarea>
                    <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>
                    </td>
        <td class="sizeTd">
          <button class="btn btn-primary tp-btn-light sharp" *ngIf="comp?.agregado==='true'" title="Eliminar"
                  (click)="eliminarItemAgregado(comp,'PRTRF00000001')">
            <mat-icon>delete_forever</mat-icon>
          </button>
        </td>
        <td *ngIf="isFormulacion" class="sizeTd"></td> 
      </tr>
    </tbody> 
  </table> 
  
  <hr>
</div>
 
<!-- PRTLU00000001_2_3 -->
<div class="table-container" *ngIf="mostrarPRTLU0000000123"> 
  <table class="table table-sm mb-0 table-responsive-lg"  style="font-size: 14px;">              
    <thead class="sticky-top" style="color: black;">
      <tr>
        <th colspan="11" style="background: white;padding-bottom: 0px !important;">
        <h4> PRTLU :<b>{{ ListComponenteProductoPRTLU00000001_2_3[0]?.producto }}</b></h4>
        </th>
      </tr>
      <tr style="box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);">                       
        <th nowrap style="height: 8px !important;"></th>       
        <th nowrap style="height: 8px !important;">Tipo</th>       
        <th nowrap style="height: 8px !important;">Código Tipo</th>
        <th nowrap style="height: 8px !important;">Descripción Tipo</th>
        <th nowrap style="height: 8px !important;">Ancho</th>
        <th nowrap style="height: 8px !important;">Alto</th>
        <th nowrap style="height: 8px !important;">Cant. Roller</th>
        <th nowrap style="height: 8px !important;">Cálculo Final</th>
        <th nowrap style="height: 8px !important;">Merma</th>  
        <th nowrap style="height: 8px !important;">Lote</th>  
        <th nowrap style="height: 8px !important;">  
          <button class="btn btn-primary-azul tp-btn-light sharp" title="Agregar Nuevo Componente"
                  (click)="openTablePopup('PRTLU00000001_2_3')"><mat-icon>library_add</mat-icon></button> 
        </th>
        <th nowrap *ngIf="isFormulacion" style="height: 8px !important;"></th>
      </tr>
    </thead> 
    <tbody style="color: #373434;">
      <tr *ngFor="let comp of ListComponenteProductoPRTLU00000001_2_3; let i = index">
        <td>
          <button class="btn btn-primary tp-btn-light sharp" 
                  *ngIf="comp?.agregado !== 'true' && comp?.tipoDesc !== 'ACCESORIO'"
                  (click)="clonarComponente(comp,'PRTLU00000001_2_3')" 
                  title="Clonar"
                  style="margin: 0px; height: 0px !important;"><mat-icon>toll</mat-icon></button>
        </td>
        <td class="sizeTd">{{ comp.tipoDesc }}</td>                
        <td style="width: 124px !important;font-size: 12px !important;" class="sizeTd">  
          <mat-form-field appearance="outline" style="width: 100%;">
            <mat-select [disabled]="!isEditableTipo" [(ngModel)]="comp.codigoTipo" placeholder="Buscar" style="width: 190px;" (selectionChange)="onNombreChange($event, comp)">
              <mat-select-trigger>
                <span *ngIf="!comp.codigoTipo">
                  {{ comp.codigoTipo || '---Seleccione---' }}                                        
                </span>
                <span *ngIf="comp.codigoTipo">
                  {{ comp.codigoTipo || comp.codigoTipo }}                                        
                </span>
              </mat-select-trigger>
              <input matInput (keyup)="applyFilter($event, comp)" placeholder="Buscar" class="search-input" />
              <mat-option *ngIf="!comp.filteredOptions">Cargando...</mat-option> 
              <mat-option *ngIf="!isOptionInFilteredOptions(comp.codigoTipo, comp.filteredOptions)" [value]="comp.codigoTipo">
                {{ comp.codigoTipo }} : {{ comp.codigoTipo }}
              </mat-option>                                
              <mat-option value="">---Seleccione---</mat-option>
              <mat-option *ngFor="let item of comp.filteredOptions" [value]="item.codigoTipo">
                {{ item.codigoTipo }} : {{ item.descripcionTipo }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </td>
        <td class="sizeTd">{{comp.descripcionTipo}}</td> 
        <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.ancho" *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>  
          <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
        </td>  
        <td style="text-align: center;min-width: 127px !important;" class="sizeTd"> 
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.alto" *ngIf="comp.tipoDesc === 'TELA'" />
          <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>                        
        </td> 
        <td class="sizeTd">                            
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.cantidadRoller" />
        </td> 
        <td style="min-width: 127px !important;" class="sizeTd">
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.calculoFinal" (input)="validateAndFormatInput($event)" [disabled]="!isEditableCalculo"/>
        </td>
        <td style="min-width: 55px !important;" class="sizeTd">
          <input type="number" class="form-control input-sm" min="0" style="height: 33px !important;font-size: 14px;"
                 [(ngModel)]="comp.merma" (input)="validateAndFormatInput($event)" [disabled]="!isEditableMerma"
                 *ngIf="comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA'"/>
          <span *ngIf="!(comp.tipoDesc === 'TUBO' || comp.tipoDesc === 'RIEL' || comp.tipoDesc === 'TELA')">--</span>
        </td>  
                    <td style="min-width: 55px !important;" class="sizeTd">
                    <textarea class="form-control input-sm"   rows="1"  style="height: 50px !important; font-size: 14px;"   [(ngModel)]="comp.lote"                   
                     *ngIf="comp.tipoDesc === 'TELA'">
                    </textarea>
                    <span *ngIf="comp.tipoDesc !== 'TELA'">--</span>
                    </td>
        <td class="sizeTd">
          <button class="btn btn-primary tp-btn-light sharp" *ngIf="comp?.agregado==='true'" title="Eliminar"
                  (click)="eliminarItemAgregado(comp,'PRTLU00000001_2_3')">
            <mat-icon>delete_forever</mat-icon>
          </button>
        </td>
        <td *ngIf="isFormulacion" class="sizeTd"></td> 
      </tr>
    </tbody> 
  </table> 
</div>

    </div>
</div>
<div mat-dialog-actions>
   <button mat-button class="btn btn-sm btn-primary" (click)="guardarComponentes()">
        Guardar 
    </button>
    <button mat-button (click)="close()">Cerrar</button>
</div>